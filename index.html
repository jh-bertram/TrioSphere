<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TrioSphere</title>

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- SheetJS for Excel reading -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

  <!-- Marked.js for Markdown parsing -->
  <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>

</head>
<link rel="stylesheet" href="style.css">

<body>
  <nav class="navbar">
    <div class="container">
        <a class="brand" href="home.html">TrioSphere</a>

        <div class="menu">
        <a href="home.html">Home</a>
        <a href="index.html">Data</a>
        <a href="about.html">About</a>
        </div>

        <div class="nav-buttons">
          <a href="https://onehealth.colostate.edu/" target="_blank" rel="noopener noreferrer" class="cta-btn-small">CSU One Health</a>
          <a href="https://dsri.colostate.edu/" target="_blank" rel="noopener noreferrer" class="cta-btn-small">CSU DSRI</a>
        </div>
    </div>
    </nav>
  <header>
    <div class="header-intro">
    <h1>TrioSphere</h1>
    <p>
      A central hub for high-quality spatial and tabular data spanning biological variability, ecosystems, public health, and more. Browse or fine-tune filters to surface exactly what you need—then grab the data in a click.
    </p>
  </div>
  <div class="header-controls">
      <div id="searchBar">
        <label class="visually-hidden" for="searchInput">Search all data</label>
        <input id="searchInput" type="search" placeholder="Search data…" autocomplete="off">
        <svg width="18" height="18" viewBox="0 0 24 24">
          <path d="M10 2a8 8 0 105.293 14.707l4.5 4.5 1.414-1.414-4.5-4.5A8 8 0 0010 2zm0 2a6 6 0 110 12 6 6 0 010-12z"></path>
        </svg>
      </div>

      <div class="search-category-container">
      <div id="categoryPills">
        <div class="pill-list">
          <span class="pill" data-value="Animals">Animals</span>
          <span class="pill" data-value="People">People</span>
          <span class="pill" data-value="Ecosystems">Ecosystems</span>
        </div>
      </div>
    </div>
  </div>
</header>

<div id="resultsBar">
  <div class="results-container">
    <span id="resultCounter" class="result-count">
      <i class="fas fa-spinner fa-spin"></i> Loading datasets from Excel...
    </span>
    <div class="results-actions">
      <div class="view-toggle" role="group" aria-label="View mode">
        <button id="viewToggleCard" class="view-toggle-btn active" title="Card view" aria-pressed="true">
          <i class="fas fa-th"></i>
        </button>
        <button id="viewToggleList" class="view-toggle-btn" title="List view" aria-pressed="false">
          <i class="fas fa-list"></i>
        </button>
        <button id="viewTogglePreview" class="view-toggle-btn" title="Preview view" aria-pressed="false">
          <i class="fas fa-image"></i>
        </button>
      </div>
      <button id="exportCsvBtn" class="export-btn" title="Export filtered results to CSV">
        <i class="fas fa-download"></i> Export to CSV
      </button>
    </div>
  </div>
</div>

<main>
  <button id="filterToggleBtn" class="filter-toggle-btn" aria-expanded="false">
    <i class="fas fa-filter"></i> Filters
  </button>
  <aside id="filterPanel">
      <h2>Search Criteria</h2>

      <div class="filter-group">
        <strong>Filter</strong>
        <div id="tagFiltersContainer">
          </div>
      </div>
      <div class="filter-group">
        <strong>Source</strong>
        <div>
          <label><input type="checkbox" class="filter-checkbox" data-filter-group="type" value="Dataset" checked> Dataset</label>
        </div>
        <div>
          <label><input type="checkbox" class="filter-checkbox" data-filter-group="type" value="Database" checked> Database</label>
        </div>
      </div>
      <div class="filter-group">
      <strong>Region</strong>
      <div id="regionFiltersContainer">
        </div>
      </div>
      <div class="filter-group">
        <strong>Year Range</strong>
        <label for="dateStart">Start</label>
        <input type="number" id="dateStart" placeholder="e.g. 2000" min="1000" max="2100">
        <label for="dateEnd">End</label>
        <input type="number" id="dateEnd" placeholder="e.g. 2025"  min="1000" max="2100">
      </div>
      <button id="clearFilters" class="download" style="align-self:flex-start;background:var(--clr-accent);margin-top:.25rem;">Clear All</button>

      <div class="suggestion-group">
        <p style="font-size: 0.9rem; font-weight: 500;">Have a dataset to suggest?</p>
        <button id="openSuggestionModalBtn" class="btn" style="width: 100%;">Leave Feedback</button>
      </div>
    </aside>
    <section id="datasetGrid" aria-live="polite"></section>
  </main>
  <div class="filter-overlay" id="filterOverlay"></div>
  <div id="infoModal" class="modal hidden">
    <div class="modal-content">
      <button id="modalClose" class="modal-close">&times;</button>
      <h2 id="modalTitle"></h2>
      <div id="modalBody"></div>
      <footer class="modal-footer">
        <button id="modalDownload" class="download">Download From Site</button>
      </footer>
    </div>
  </div>

  <div id="suggestionModal" class="modal hidden">
    <div class="modal-content">
      <button id="suggestionModalClose" class="modal-close">&times;</button>
      <h2 id="suggestionModalTitle">Suggest a Dataset or Leave Feedback</h2>
      <p style="margin: 0.5rem 0 1rem; line-height: 1.5;">
        Found a dataset we're missing? Have a link, a name, or just a general idea? Or do you have feedback on the site? Let us know below!
      </p>
      <form id="suggestionForm">
        <label for="suggestionText" class="visually-hidden">Feedback or suggestion</label>
        <textarea id="suggestionText" placeholder="Paste a link, describe a dataset, or leave your feedback here..." rows="8" required></textarea>
        <footer class="modal-footer">
          <button type="submit" class="btn">Submit Feedback</button>
        </footer>
      </form>
    </div>
  </div>

  <!-- Note: data.js is no longer needed - we load directly from Excel -->
  <!-- <script src="data.js" defer></script> -->

<script src="script.js" defer></script>
  </body>
</html>